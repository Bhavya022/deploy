<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Page</title>
    <style>
      /* All Your css for Home page goes here  */ 

      #restaurant-container{
        display: grid; 
        width: 90%; 
        grid-template-columns: repeat(4,1fr); 
        margin: auto;  
        gap: 20px;
      } 
      img{
        width:100%;
      } 
      button{
        background-color: lightskyblue;
        color: white;
      }
    </style>
  </head>

  <body>
    <div class="nav">
      <h1>Masai Restaurant Finder</h1>
      <a href="./index.html">Home</a>
      <a href="./favourites.html">Favourites</a>
    </div>
    <select id="filter">
      <option value="">Filter By Category</option>
      <option value="cafe">cafe</option>
      <option value="ethnic">ethnic</option>
      <option value="fast_food">fast_food</option>
    </select>
    <h1 id="alert"></h1>
    <div id="restaurant-container">
      <!-- Here Append All the Products  -->
    </div>
  </body>
  <script>
    const url = `https://dbioz2ek0e.execute-api.ap-south-1.amazonaws.com/mockapi/getrestaurants?limit=30`;
    // All your JS code for Home Page goes here 
    let container = document.getElementById("restaurant-container"); 
    let filter = document.getElementById("filter"); 
    let alert = document.getElementById("alert")
    let fetchdata=[] 

    //filter part  
   filter.addEventListener("change",()=>{
    let filtered=fetchdata.filter((element)=>{
      if(element.type === filter.value){
        return true;
      } 
      else{
        return false;
      }
    }) 
    display(filtered)
   })

    //fetch part
   fetch(url)
   //console.log(val); 
   .then((res)=>{
    return res.json();
   }) 
   .then((actualdata)=>{
    fetchdata = actualdata.data; 
    console.log(actualdata.data) 
    display(actualdata.data)
   }) 
   .catch((error)=>{
    console.log(error);
   })    
    //display part
   function display(data){
    container.innerHTML=null;
    data.forEach((element) => {
      
      let card = document.createElement("div")
      let image = document.createElement("img")
      image.setAttribute("src",element.image) 
      let name = document.createElement("h3")
      name.innerText=element.name;
      let price = document.createElement("h6")
      price.innerText=element.price_starts_from;
      let type = document.createElement("p") 
      type.innerText=element.type;
      let rating = document.createElement("p") 
      rating.innerText=element.rating
     let Favourites = document.createElement("button");
     Favourites.innerText="Favourites"; 
     Favourites.addEventListener("click",()=>{
     let restdata = JSON.parse(localStorage.getItem("favourites"))  
     if(restdata==null){
      restdata=[]
     } 
     let ispresent = false;
     for(let i=0;i<restdata.length;i++){
      if(restdata[i].id===element.id){
        ispresent=true;
        break;
      }
     } 
     if(ispresent===true){
      alert.innerText="Restaurant Already in Favourites";
     } 
     else{ 
      restdata.push(element);
      localStorage.setItem("favourites",JSON.stringify(restdata))
      alert.innerText="Restaurant Added To Favourites"
     }
     })
     card.append(image,name,price,type,rating,Favourites) 
     container.append(card);

    });
   }
  </script>
</html>
